DROP DATABASE IF EXISTS EXAM;
CREATE DATABASE EXAM;

USE EXAM;

CREATE TABLE  TB1(
	NUMBER CHAR(4) PRIMARY KEY,
    NAME VARCHAR(4) NOT NULL,
    AGE INT
    );
    
    SELECT *
    FROM TB1;
    
INSERT INTO TB1
VALUES('A101', '강신우' , 40), ('A102', '김기덕' , 28), ('A103', '김민호' , 20),
('A104', '문소리' , 40), ('A105', '박문수' , 40), ('A106', '김기덕' , 40);
    
ALTER TABLE TB1
ADD COLUMN GENDER CHAR(1) DEFAULT '남';

UPDATE TB1 
SET NAME = '김기범'
WHERE AGE = 28;

DELETE 
FROM TB1
WHERE NAME = '문소리';

-- SQL SELECT 1번문제

CREATE DATABASE EMP;
USE EMP;

CREATE TABLE EMP(
EMPNO INT PRIMARY KEY,
ENAME CHAR(6),
JOB CHAR(10),
MGR INT,
HIREDATE DATETIME,
SAL INT,
COMM INT,
DEPTNO SMALLINT
);

INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7369 , 'SMITH', 'CLERK', 7902, '1980-12-17 0:00', 800, NULL ,20);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7499, 'ALLEN', 'SALESMAN',7698,'1981-02-20 0:00',1600,300,30);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7521, 'WARD', 'SALESMAN',7698,'1981-02-22 0:00',1250,500,30);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7566, 'JONES', 'MANAGER',7839,'1981-04-02 0:00',2975,NULL,20);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7654, 'MARTIN', 'SALESMAN',7698,'1981-09-28 0:00',1250,1400,30);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7698, 'BLAKE', 'MANAGER',7839,'1981-05-01 0:00',2850,NULL,30);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7782, 'CLARK', 'MANAGER',7839,'1981-06-09 0:00',2450,NULL,10);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7788, 'SCOTT', 'ANALYST',7566,'1982-12-09 0:00',3000,NULL,20);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7839, 'KING', 'PRESIDENT',NULL,'1981-11-17 0:00',5000,NULL,10);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7844, 'TURNER', 'SALESMAN',7698,'1981-09-08 0:00',1500,0,30);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7876, 'ADAMS', 'CLERK',7788,'1983-01-12 0:00',1100,NULL,20);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7900, 'JAMES', 'CLERK',7698,'1981-12-03 0:00',950,NULL,30);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7902, 'FORD', 'ANALYST',7566,'1981-12-03 0:00',3000,NULL,20);
INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES (7934, 'MILLER', 'CLERK',7782,'1982-01-23 0:00',1300,NULL,10);

SELECT *
FROM EMP;

-- 첫번째 SELECT문제 --

-- 1번 --
SELECT EMPNO, ENAME, SAL
FROM EMP
WHERE DEPTNO= 10;

-- 2번 --
SELECT ENAME, HIREDATE, DEPTNO
FROM EMP
WHERE EMPNO = 7369;

-- 3번 --
SELECT *
FROM EMP
WHERE ENAME = 'ALLEN';

-- 4번 --
SELECT ENAME, DEPTNO, SAL
FROM EMP
WHERE HIREDATE = '1983-01-12';


-- 5번 --
SELECT *
FROM EMP
WHERE JOB NOT IN ('MANAGER'); 


-- 6번 --
SELECT *
FROM EMP
WHERE ENAME > 'K';

-- 7번 --
SELECT ENAME, SAL, DEPTNO
FROM EMP
WHERE HIREDATE BETWEEN '1981-04-02' AND '1982-12-09';

-- 8번 --
SELECT *
FROM EMP
WHERE ENAME LIKE "%S%";

-- 9번 --
SELECT *
FROM EMP
WHERE ENAME LIKE "S%T";

-- 10번 -- 
SELECT *
FROM EMP
WHERE ENAME LIKE "_A%";

-- 11번 --
SELECT *
FROM EMP
ORDER BY SAL DESC;

-- 12번 --
SELECT EMPNO, ENAME, DEPTNO
FROM EMP
WHERE ENAME LIKE "K%" OR DEPTNO = 30;

-- 13번 --
SELECT *
FROM EMP
WHERE (SAL >= 1500 AND DEPTNO = 30) AND JOB = 'MANAGER';


-- 두번째 SELECT문제 --

-- 1번 --
SELECT *
FROM EMP
WHERE EMPNO BETWEEN 7654 AND 7782;

-- 2번 --
SELECT *
FROM EMP
WHERE ENAME BETWEEN 'B' AND 'J';

-- 3번 --
SELECT *
FROM EMP
WHERE YEAR(HIREDATE) != 1981 ;

-- 4번 --
SELECT *
FROM EMP
WHERE JOB IN('MANAGER', 'SALESMAN');

-- 5번 --
SELECT ENAME, EMPNO, DEPTNO
FROM EMP
WHERE DEPTNO NOT IN(20,30);

-- 6번 --
SELECT EMPNO, ENAME, HIREDATE, DEPTNO
FROM EMP
WHERE ENAME LIKE "S%";

-- 7번 --
SELECT *
FROM EMP
 WHERE YEAR(HIREDATE) = 1981;

-- 8번 --
SELECT *
FROM EMP
WHERE ENAME LIKE "%S%";

-- 9번 --
SELECT *
FROM EMP
WHERE ENAME LIKE "S%T";

-- 10번 --
SELECT *
FROM EMP
WHERE ENAME LIKE "_A%";

-- 11번 --
SELECT *
FROM EMP
WHERE COMM IS NULL;

-- 12번 --
SELECT *
FROM EMP
WHERE COMM IS NOT NULL;

-- 13번 -- 
SELECT ENAME, DEPTNO , SAL
FROM EMP
WHERE DEPTNO = 30 AND SAL >= 1500;

-- 14번 --
SELECT EMPNO, ENAME, DEPTNO
FROM EMP
WHERE ENAME LIKE "k%" OR DEPTNO = 30;

-- 15번 --
SELECT *
FROM EMP
WHERE (SAL>=1500 AND DEPTNO = 30) AND JOB = 'MANAGER';
 
 
 -- 세번째 SELECT문제 --
 CREATE DATABASE DEPT;
 USE DEPT;
 
 CREATE TABLE DEPT(
 DEPTNO INT,
 DNAME CHAR(15),
 LOC CHAR(15)
 );
 
 INSERT INTO DEPT VALUES (10, 'ACCOUNTING', 'NEW YORK'), (20, 'RESEARCH', 'DALLAS'), (30, 'SALES', 'CHICAGO'),
 (40, 'OPERATIONS', 'BOSTON'), (50, 'DEVELOPER', 'KOREA');
 
 SELECT *
 FROM DEPT;

-- 1번 --
SELECT A.ENAME, B.DNAME, A.SAL, A.JOB
FROM EMP A JOIN DEPT B
ON A.DEPTNO = B.DEPTNO
WHERE A.JOB = (SELECT JOB FROM EMP WHERE ENAME = 'ALLEN');

-- 2번 --
SELECT A.EMPNO, A.ENAME, A.HIREDATE, A.SAL
FROM EMP A JOIN DEPT B
ON B.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME ='JONES');

-- 3번 --
SELECT A.EMPNO, A.ENAME, B.DNAME, A.HIREDATE, B.LOC, A.SAL
FROM EMP A JOIN DEPT B
ON A.DEPTNO = B.DEPTNO
WHERE A.SAL > (SELECT AVG(SAL) FROM EMP);

-- 4번 --
SELECT A.EMPNO, A.ENAME, B.DNAME, B.LOC, A.SAL
FROM EMP A JOIN DEPT B
ON A.DEPTNO = B.DEPTNO
WHERE B.DEPTNO = 10
ORDER BY SAL DESC;

-- 5번 --
SELECT EMPNO, ENAME, SAL
FROM EMP
WHERE SAL IN (SELECT SAL FROM EMP WHERE ENAME IN ('MARTIN', 'SCOTT'));

-- 6번 --
SELECT EMPNO, ENAME, SAL
FROM EMP
WHERE SAL > (SELECT MAX(SAL) FROM EMP WHERE DEPTNO = 30);

-- 7번 --
SELECT 
